name: release

on:
  pull_request:
    branches: master
  
jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: Set up JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8

    - name: Get latest release version
      run: |
        curl -X GET \
          https://api.github.com/repos/whelk-io/flesch-kincaid/releases/latest \
          -o /tmp/release.json
           
    - name: temp2
      run: |
        cat /tmp/release.json
        
    - name: temp
      run: |
        cat /tmp/release.json | grep version -m 1 | awk '{$1=$1};1'
        
    - name: Build with Maven
      run: mvn -B test --file pom.xml
    - name: Update version
      run: mvn -B release:update-versions --batch-mode --file pom.xml


